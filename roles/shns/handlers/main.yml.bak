---
# handlers file for shns
- name: set script
  shell:
    cmd: sh init_C.sh
    chdir: /tmp
  ignore_errors: yes
  listen: restart shns all service

- name: start service
  shell:
    cmd: sh autostart.sh
    chdir: /opt/script
  ignore_errors: yes
  listen: restart shns all service

- name: send mail to leader
  mail:
    host: smtp.qq.com
    port: 465
    username: 953409930@qq.com
    password: tegkucszydnxbdha
    from: 953409930@qq.com
    to: b953409930@126.com
    # cc: Wang Wu <wangwu@gmail.com>, Li Si <Lisi@163.com>
    #attach: /etc/fstab /etc/hosts
    subject: "{{ mail_subject }}"
    body: "{{ shsrs_host }}:{{ hostvars['{{ shsrs_host }}'].shsrs_license.stdout_lines[1] }}\n{{ inventory_hostname }}:{{ shns_license.stdout_lines[1] }}"
